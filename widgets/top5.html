<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LLM Top 5</title>
<style>
  :root { --bg:#fff; --fg:#0f172a; --muted:#475569; --line:#e5e7eb; }
  body { margin:0; font:14px/1.5 system-ui, -apple-system, Segoe UI, Roboto, Arial; color:var(--fg); background:var(--bg);}
  .wrap{ padding:14px }
  h3 { margin:0 0 10px; font-size:16px }
  .card{ border:1px solid var(--line); border-radius:12px; overflow:hidden; background:#fff }
  .row{ display:flex; justify-content:space-between; align-items:center; padding:10px 12px; border-top:1px dashed #f1f5f9 }
  .row:first-child{ border-top:0 }
  .rank{ width:26px;height:26px;border-radius:9999px;background:#0f172a;color:#fff;display:flex;align-items:center;justify-content:center;font-weight:600;font-size:12px;margin-right:8px }
  .name{ min-width:0; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; font-weight:500 }
  .val{ font-variant-numeric:tabular-nums }
  .muted{ color:var(--muted); font-size:12px; margin-top:8px }
</style>
</head>
<body>
<div class="wrap">
  <h3 id="title">Top 5</h3>
  <div class="card" id="list"></div>
  <div class="muted" id="foot"></div>
</div>
<script>
const params = new URLSearchParams(location.hash.slice(1)); // #section=code
const section = params.get('section') || 'code'
const labelMap = {
  code:['Meilleur LLM – Code','%'],
  multimodal:['Meilleur LLM – Multimodal','%'],
  knowledge:['Meilleur LLM – Connaissances','%'],
  longest_context:['Contexte le plus long','tokens'],
  cheapest:['Fournisseur API le moins cher','$ / 1M'],
  fastest:['Fournisseur API le plus rapide','tokens/s'],
}
document.getElementById('title').textContent = labelMap[section]?.[0] || 'Top 5'

async function fetchJSON(){
  // top-leaderboards.json is one level up from widgets/
  const url = new URL('../top-leaderboards.json', location.href).href
  const res = await fetch(url, {cache:'no-store'})
  return res.json()
}

function render(data){
  const tgt = document.getElementById('list')
  tgt.innerHTML = ''
  const arr = data[section] || []
  arr.slice(0,5).forEach((it, i)=>{
    const div = document.createElement('div')
    div.className = 'row'
    div.innerHTML = `
      <div style="display:flex;align-items:center;min-width:0;flex:1">
        <span class="rank">${i+1}</span>
        <span class="name">${(it.name||'').replace(/</g,'&lt;')}</span>
      </div>
      <div class="val">${it.score!=null ? (it.score.toFixed(1)+'%') : (it.value||'')}</div>
    `
    tgt.appendChild(div)
  })
  const updated = (data.last_updated || '').replace('T',' ').replace('Z',' UTC')
  document.getElementById('foot').textContent = updated ? `Mise à jour: ${updated}` : ''
}

fetchJSON().then(render).catch(e=>{
  document.getElementById('foot').textContent = 'Erreur de chargement'
  console.error(e)
})
</script>
</body>
</html>
